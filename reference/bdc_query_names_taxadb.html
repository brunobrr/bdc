<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Harmonizing taxon names against local stored taxonomic databases — bdc_query_names_taxadb • bdc</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Harmonizing taxon names against local stored taxonomic databases — bdc_query_names_taxadb"><meta property="og:description" content="Harmonizing taxon names against local stored taxonomic databases"><meta property="og:image" content="https://brunobrr.github.io/bdc/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bdc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>

    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/integrate_datasets.html">Standardization and integration of different datasets</a>
    </li>
    <li>
      <a href="../articles/prefilter.html">Pre-filter</a>
    </li>
    <li>
      <a href="../articles/taxonomy.html">Taxonomy</a>
    </li>
    <li>
      <a href="../articles/space.html">Space</a>
    </li>
    <li>
      <a href="../articles/time.html">Time</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/brunobrr/bdc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Harmonizing taxon names against local stored taxonomic databases</h1>
    <small class="dont-index">Source: <a href="https://github.com/brunobrr/bdc/blob/master/R/bdc_query_names_taxadb.R" class="external-link"><code>R/bdc_query_names_taxadb.R</code></a></small>
    <div class="hidden name"><code>bdc_query_names_taxadb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Harmonizing taxon names against local stored taxonomic databases</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bdc_query_names_taxadb</span><span class="op">(</span></span>
<span>  <span class="va">sci_name</span>,</span>
<span>  replace_synonyms <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  suggest_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  suggestion_distance <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  db <span class="op">=</span> <span class="st">"gbif"</span>,</span>
<span>  rank_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rank <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  export_accepted <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-sci-name">sci_name<a class="anchor" aria-label="anchor" href="#arg-sci-name"></a></dt>
<dd><p>character string. Containing scientific names to be queried.</p></dd>


<dt id="arg-replace-synonyms">replace_synonyms<a class="anchor" aria-label="anchor" href="#arg-replace-synonyms"></a></dt>
<dd><p>logical. Should synonyms be replaced by accepted
names? Default = TRUE.</p></dd>


<dt id="arg-suggest-names">suggest_names<a class="anchor" aria-label="anchor" href="#arg-suggest-names"></a></dt>
<dd><p>logical. Tries to find potential candidate names for
misspelled names not resolved by an exact match. Default = TRUE.</p></dd>


<dt id="arg-suggestion-distance">suggestion_distance<a class="anchor" aria-label="anchor" href="#arg-suggestion-distance"></a></dt>
<dd><p>numeric. A threshold value determining the
acceptable orthographical distance between searched and candidate names.
Names with matching distance value lower threshold informed are returned as
NA. Default = 0.9.</p></dd>


<dt id="arg-db">db<a class="anchor" aria-label="anchor" href="#arg-db"></a></dt>
<dd><p>character string. The name of the taxonomic database to
be used in harmonizing taxon names. Default = "gbif".
Use "all" to install all available taxonomic databases automatically.</p></dd>


<dt id="arg-rank-name">rank_name<a class="anchor" aria-label="anchor" href="#arg-rank-name"></a></dt>
<dd><p>character string. Taxonomic rank name (e.g. "Plantae",
"Animalia", "Aves", "Carnivora". Default = NULL.</p></dd>


<dt id="arg-rank">rank<a class="anchor" aria-label="anchor" href="#arg-rank"></a></dt>
<dd><p>character string. A taxonomic rank used to filter the
taxonomic database. Options available are: "kingdom", "phylum", "class",
"order", "family", and "genus".</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical. Should a parallelization process be used?
Default=FALSE</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>numeric. The number of cores to run in parallel.</p></dd>


<dt id="arg-export-accepted">export_accepted<a class="anchor" aria-label="anchor" href="#arg-export-accepted"></a></dt>
<dd><p>logical. Should a table containing records
with names linked to multiple accepted names saved for further
inspection. Default = FALSE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>This function returns data.frame containing the results of the
taxonomic harmonization process. The database is returned in the same order
of sci_name.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The taxonomic harmonization is based upon one taxonomic authority database.
The lastest version of each database is used to perform queries, but
note that only older versions are available for some taxonomic databases. The
database version is shown in parenthesis. Note that some databases are
momentary unavailable in taxadb.</p><ul><li><p><strong>itis</strong>: Integrated Taxonomic Information System (v. 2022)</p></li>
<li><p><strong>ncbi</strong>: National Center for Biotechnology Information (v. 2022)</p></li>
<li><p><strong>col</strong>: Catalogue of Life (v. 2022)</p></li>
<li><p><strong>tpl</strong>: The Plant List (v. 2019)</p></li>
<li><p><strong>gbif</strong>: Global Biodiversity Information Facility (v. 2022)</p></li>
<li><p><strong>fb</strong>: FishBase (v. 2019)</p></li>
<li><p><strong>slb</strong>: SeaLifeBase (unavailable)</p></li>
<li><p><strong>wd</strong>: Wikidata (unavailable)</p></li>
<li><p><strong>ott</strong>: OpenTree Taxonomy (v. 2021)</p></li>
<li><p><strong>iucn</strong>: International Union for Conservation of Nature (v. 2019)</p></li>
</ul><p>The bdc_query_names_taxadb processes as this:</p>
<p><strong>Creation of a local taxonomic database</strong></p>
<p>This is a one-time setup used to download, extract, and import the taxonomic
databases specified in the argument "db". The downloading process may take a
few minutes depending on your connection and database size. By default, the
"gbif" database following a Darwin Core schema is installed. (see
?taxadb::td_create for details).</p>
<p><strong>Taxonomic harmonization</strong></p>
<p>The taxonomic harmonization is divided into two distinct phases according to
the matching type to be undertaken.</p>
<p><strong>Exact matching</strong></p>
<p>Firstly, the algorithm attempts to find an exact matching
for each original scientific name supplied using the function "filter_name"
from taxadb package. If an exact matching cannot be found, names are returned
as Not Available (NA). Also, it is possible that a scientific name match
multiple accepted names. In such cases, the "bdc_clean_duplicates" function
is used to flag and remove names with multiple accepted names.</p>
<p>Information on higher taxa (e.g., kingdom or phylum) can be used to
disambiguate names linked to multiple accepted names. For example, the genus
"Casearia" is present in both Animalia and Plantae kingdoms. When handling
names of Plantae, it would be helpful to get rid of names belonging to the
Animalia to avoid flagging "Caseria" as having multiple accepted names.
Following Norman et al. (2020), such cases are left to be fixed by the user.
If "export_accepted" = TRUE a database containing a list of all records with
names linked to multiple accepted names is saved in the "Output" folder.</p>
<p><strong>Fuzzy matching</strong></p>
<p>Fuzzy matching will be applied when "suggest_names" is TRUE and only for
names not resolved by an exact match. In such cases, a fuzzy matching
algorithm processes name-matching queries to find a potential matching
candidate from the specified taxonomic database. Fuzzy matching identifies
probable names (here identified as suggested names) for original names via a
measure of orthographic similarity (i.e., distance). Orthographic distance is
calculated by optimal string alignment (restricted Damerau-Levenshtein
distance) that counts the number of deletions, insertions, substitutions, and
adjacent characters' transpositions. It ranges from 0 to 1, being 1 an
indicative of a perfect match. A threshold distance, i.e. the lower value of
match acceptable, can be informed by user (in the "suggest_distance"
argument). If the distance of a candidate name is equal or higher than the
distance informed by user, the candidate name is returned as suggested name.
Otherwise, names are returned as NA.</p>
<p>To increase the probability of finding a potential match candidate and to
save time, two steps are taken before conducting fuzzy matching. First, if
supplied, information on higher taxon (e.g., kingdom, family) is used to
filter the taxonomic database. This step removes matching ambiguity by
avoiding matching names from unrelated taxonomic ranks (e.g., match a plant
species against a taxonomic database containing animal names) and decreases
the number of names in the taxonomic database used to calculate the matching
distance. Then, the taxonomic database is filtered according to a set of
firsts letters of all input names. This process reduces the number of names
in the taxonomic database to which each original name should be compared When
a same suggested name is returned for different input names, a warning is
returned asking users to check whether the suggested name is valid.</p>
<p><strong>Report</strong></p>
<p>The name harmonization processes' quality can be accessed in the column
"notes" placed in the table resulting from the name harmonization process.
The column "notes" contains assertions on the name harmonization process
based on Carvalho (2017). The notes can be grouped in two categories:
accepted names and those with a taxonomic issue or warning, needing further
inspections. Accepted names can be returned as "accepted" (valid accepted
name), "replaceSynonym" (a synonym replaced by an accepted name),
"wasMisspelled" (original name was misspelled), "wasMisspelled |
replaceSynonym" (misspelled synonym replaced by an accepted name), and
"synonym" (original names is a synonym without accepted names in the
database). Similarly, the following notes are used to flag taxonomic issues:
"notFound" (no matching name found), "multipleAccepted" (name with multiple
accepted names), "noAcceptedName" (no accepted name found), and ambiguous
synonyms such as "heterotypic synonym", "homotypic synonym", and "pro-parte
synonym". Ambiguous synonyms, names that have been published more than once
describing different species, have more than one accepted name and cannot be
resolved. Such cases are flagged and left to be determined by the user.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other taxonomy:
<code><a href="bdc_clean_names.html">bdc_clean_names</a>()</code>,
<code><a href="bdc_filter_out_names.html">bdc_filter_out_names</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">sci_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Polystachya estrellensis"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Tachigali rubiginosa"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Oxalis rhombeo ovata"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Axonopus canescens"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Prosopis"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Haematococcus salinus"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Monas pulvisculus"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Cryptomonas lenticulari"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Poincianella pyramidalis"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Hymenophyllum polyanthos"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">names_harmonization</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">bdc_query_names_taxadb</span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="va">sci_name</span>,</span></span>
<span class="r-in"><span>      replace_synonyms <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      suggest_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      suggestion_distance <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>      db <span class="op">=</span> <span class="st">"gbif"</span>,</span></span>
<span class="r-in"><span>      parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      ncores <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>      export_accepted <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bruno Ribeiro, Santiago Velazco, Karlo Guidoni-Martins, Geiziane Tessarolo, Lucas Jardim.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

