<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Space • bdc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Space">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bdc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>

    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/integrate_datasets.html">Standardization and integration of different datasets</a>
    </li>
    <li>
      <a href="../articles/prefilter.html">Pre-filter</a>
    </li>
    <li>
      <a href="../articles/taxonomy.html">Taxonomy</a>
    </li>
    <li>
      <a href="../articles/space.html">Space</a>
    </li>
    <li>
      <a href="../articles/time.html">Time</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/help/installing_gnparser.html">
    <span class="fas fa-question-circle"></span>

    Help
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brunobrr/bdc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="space_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="space_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="space_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="space_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="space_files/datatables-binding-0.33/datatables.js"></script><link href="space_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="space_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="space_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="space_files/dt-ext-fixedcolumns-1.13.6/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="space_files/dt-ext-fixedcolumns-1.13.6/js/dataTables.fixedColumns.min.js"></script><link href="space_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="space_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Space</h1>
            
            <h4 data-toc-skip class="date">2024-12-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/brunobrr/bdc/blob/master/vignettes/articles/space.Rmd" class="external-link"><code>vignettes/articles/space.Rmd</code></a></small>
      <div class="hidden name"><code>space.Rmd</code></div>

    </div>

    
    
<div class="section level4">
<h4 id="introduction">
<strong>Introduction</strong><a class="anchor" aria-label="anchor" href="#introduction"></a>
</h4>
<p>To avoid reinventing the wheel, the proposed data-cleaning workflow uses functions for other existing packages. In this module, we used one test of the <em>bdc</em> and other tests of the <em>R</em> package <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.13152" class="external-link">CoordinateCleaner</a> <strong>to flag potentially erroneous, suspect, or imprecise geographical coordinates</strong> based on geographic gazetteers and metadata. It includes a series of tests for identifying records assigned to capitals, provinces, and country centroids, coordinates in urban areas, around biodiversity institutions, or GBIF headquarters. It also contains tests to flag coordinates below a determined precision (e.g., 100 km), zero or equal coordinates, and duplicated records (i.e., equal taxa name and coordinates).</p>
<p>Note that we do not use the “seas” test to remove records in the ocean because such records we previously removed in the pre-filter module of the package (more details <a href="https://brunobrr.github.io/bdc/articles/prefilter.html">here</a>).</p>
<p>⚠️<strong>IMPORTANT:</strong></p>
<p>The results of the VALIDATION test used to flag data quality are appended in separate fields in this database and retrieved as TRUE (✅ ok) or FALSE (❌check carefully).</p>
</div>
<div class="section level4">
<h4 id="installation">
<strong>Installation</strong><a class="anchor" aria-label="anchor" href="#installation"></a>
</h4>
<p>Check <a href="https://brunobrr.github.io/bdc/#installation"><strong>here</strong></a> how to install the bdc package.</p>
</div>
<div class="section level4">
<h4 id="reading-the-database">Reading the database<a class="anchor" aria-label="anchor" href="#reading-the-database"></a>
</h4>
<p>Reading the database created in the <a href="https://brunobrr.github.io/bdc/articles/taxonomy.html"><strong>taxonomy</strong></a> module the <em>bdc</em> package. It is also possible to read any datasets containing the <strong>required</strong> fields to run the function (more details <a href="https://brunobrr.github.io/bdc/articles/integrate_datasets.html">here</a>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">database</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"Output/Intermediate/02_taxonomy_database.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="flagging-common-spatial-issues">
<strong>Flagging common spatial issues</strong><a class="anchor" aria-label="anchor" href="#flagging-common-spatial-issues"></a>
</h4>
<p>This function identifyes records with a coordinate precision below a specified number of decimal places. For example, the precision of a coordinate with 1 decimal place is 11.132 km at the equator, i.e., the scale of a large city.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">check_space</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/bdc_coordinates_precision.html">bdc_coordinates_precision</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">database</span>,</span>
<span>    lon <span class="op">=</span> <span class="st">"decimalLongitude"</span>,</span>
<span>    lat <span class="op">=</span> <span class="st">"decimalLatitude"</span>,</span>
<span>    ndec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># number of decimals to be tested</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; bdc_coordinates_precision:</span></span>
<span><span class="co">#&gt; Flagged 2 records</span></span>
<span><span class="co">#&gt; One column was added to the database.</span></span></code></pre></div>
<p>Next, we will flag common spatial issues using functions of the package <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.13152" class="external-link">CoordinateCleaner</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">check_space</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CoordinateCleaner</span><span class="fu">::</span><span class="fu"><a href="https://ropensci.github.io/CoordinateCleaner/reference/clean_coordinates.html" class="external-link">clean_coordinates</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span>  <span class="va">check_space</span>,</span>
<span>    lon <span class="op">=</span> <span class="st">"decimalLongitude"</span>,</span>
<span>    lat <span class="op">=</span> <span class="st">"decimalLatitude"</span>,</span>
<span>    species <span class="op">=</span> <span class="st">"scientificName"</span>,</span>
<span>    countries <span class="op">=</span> ,</span>
<span>    tests <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"capitals"</span>,     <span class="co"># records within 2km around country and province centroids</span></span>
<span>      <span class="st">"centroids"</span>,    <span class="co"># records within 1km of capitals centroids</span></span>
<span>      <span class="st">"duplicates"</span>,   <span class="co"># duplicated records</span></span>
<span>      <span class="st">"equal"</span>,        <span class="co"># records with equal coordinates</span></span>
<span>      <span class="st">"gbif"</span>,         <span class="co"># records within 1 degree (~111km) of GBIF headsquare</span></span>
<span>      <span class="st">"institutions"</span>, <span class="co"># records within 100m of zoo and herbaria</span></span>
<span>      <span class="st">"outliers"</span>,     <span class="co"># outliers</span></span>
<span>      <span class="st">"zeros"</span>,        <span class="co"># records with coordinates 0,0</span></span>
<span>      <span class="st">"urban"</span>         <span class="co"># records within urban areas</span></span>
<span>    <span class="op">)</span>,</span>
<span>    capitals_rad <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>    centroids_rad <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    centroids_detail <span class="op">=</span> <span class="st">"both"</span>, <span class="co"># test both country and province centroids</span></span>
<span>    inst_rad <span class="op">=</span> <span class="fl">100</span>, <span class="co"># remove zoo and herbaria within 100m</span></span>
<span>    outliers_method <span class="op">=</span> <span class="st">"quantile"</span>,</span>
<span>    outliers_mtp <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    outliers_td <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    outliers_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    range_rad <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    zeros_rad <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    capitals_ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    centroids_ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    country_ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    country_refcol <span class="op">=</span> <span class="st">"countryCode"</span>,</span>
<span>    inst_ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    range_ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="co"># seas_ref = continent_border,</span></span>
<span>    <span class="co"># seas_scale = 110,</span></span>
<span>    urban_ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    value <span class="op">=</span> <span class="st">"spatialvalid"</span> <span class="co"># result of tests are appended in separate columns</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Testing coordinate validity</span></span>
<span><span class="co">#&gt; Flagged 0 records.</span></span>
<span><span class="co">#&gt; Testing equal lat/lon</span></span>
<span><span class="co">#&gt; Flagged 0 records.</span></span>
<span><span class="co">#&gt; Testing zero coordinates</span></span>
<span><span class="co">#&gt; Flagged 0 records.</span></span>
<span><span class="co">#&gt; Testing country capitals</span></span>
<span><span class="co">#&gt; Flagged 0 records.</span></span>
<span><span class="co">#&gt; Testing country centroids</span></span>
<span><span class="co">#&gt; Flagged 0 records.</span></span>
<span><span class="co">#&gt; Testing urban areas</span></span>
<span><span class="co">#&gt; Downloading urban areas via rnaturalearth</span></span>
<span><span class="co">#&gt; trying URL 'http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/50m/cultural/ne_50m_urban_areas.zip'</span></span>
<span><span class="co">#&gt; Content type 'application/zip' length 452644 bytes (442 KB)</span></span>
<span><span class="co">#&gt; downloaded 442 KB</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; OGR data source with driver: ESRI Shapefile</span></span>
<span><span class="co">#&gt; Source: "C:\Users\Bruno R. Ribeiro\AppData\Local\Temp\RtmpCo3Lyf", layer: "ne_50m_urban_areas"</span></span>
<span><span class="co">#&gt; with 2143 features</span></span>
<span><span class="co">#&gt; It has 4 fields</span></span>
<span><span class="co">#&gt; Integer64 fields read as strings:  scalerank</span></span>
<span><span class="co">#&gt; Flagged 6 records.</span></span>
<span><span class="co">#&gt; Testing geographic outliers</span></span>
<span><span class="co">#&gt; Testing GBIF headquarters, flagging records around Copenhagen</span></span>
<span><span class="co">#&gt; Flagged 0 records.</span></span>
<span><span class="co">#&gt; Testing biodiversity institutions</span></span>
<span><span class="co">#&gt; Flagged 0 records.</span></span>
<span><span class="co">#&gt; Testing duplicates</span></span>
<span><span class="co">#&gt; Flagged 0 records.</span></span>
<span><span class="co">#&gt; Flagged 6 of 115 records, EQ = 0.05.</span></span></code></pre></div>
<p>Here we update the column named <strong>.summary</strong> summing up the results of all tests. This column is <strong>FALSE</strong> if any test was flagged as “FALSE” (❌check carefully; potentially invalid or suspect record).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">check_space</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bdc_summary_col.html">bdc_summary_col</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">check_space</span><span class="op">)</span></span>
<span><span class="co">#&gt; Column '.summary' already exist. It will be updated</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; bdc_summary_col:</span></span>
<span><span class="co">#&gt; Flagged 9 records.</span></span>
<span><span class="co">#&gt; One column was added to the database.</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["AT_EPIPHYTES_1","AT_EPIPHYTES_2","AT_EPIPHYTES_3","AT_EPIPHYTES_4","AT_EPIPHYTES_5","AT_EPIPHYTES_7","AT_EPIPHYTES_8","AT_EPIPHYTES_9","AT_EPIPHYTES_10","AT_EPIPHYTES_11","AT_EPIPHYTES_12","AT_EPIPHYTES_13","AT_EPIPHYTES_14","AT_EPIPHYTES_15","AT_EPIPHYTES_16"],["Tillandsia tenuifolia","Peperomia obtusifolia","Tillandsia recurvata","Vriesea flammea","Lankesterella ceracifolia","Nidularium innocentii","Acianthera serpentula","Peperomia quadrifolia","Peperomia circinnata","Microgramma squamulosa","Vriesea gigantea","Aechmea leptantha","Vriesea tijucana","Rhodospatha oblongata","Anthurium gaudichaudianum"],[-25.521863,-14.65972,-21.746667,-23.35,-28.1667,-26.1833,-25.5839,-26.46,-23.7869,-25.666271,-29.6411,-8.0022,-15.158634,-14.49,-29.342087],[-51.416667,-39.14972,-43.354722,-44.858333,-49.4,-49.0333,-49.6356,-49.41,-54.2836,-49.269229,-50.4525,-35.0183,-39.057151,-39.1,-49.68663],["E8802","635992","E1617","E0272","17541","20521","E23503","E18657","E16998","E7552","E0829","E1518","359","E25916","E0057"],["2003","2015","2016","2011","2009","2009",null,null,null,"2017",null,null,"2000",null,"1992"],["Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil"],["PARANA","BAHIA","MATO GROSSO DO SUL","SAO PAULO","SANTA CATARINA","SANTA CATARINA","PARANA","SANTA CATARINA","MATO GROSSO DO SUL","PARANA","RIO GRANDE DO SUL","PERNAMBUCO","BAHIA","BAHIA","RIO GRANDE DO SUL"],["GUARAPUAVA","ILHEUS","JUIZ DE FORA","UBATUBA","ORLEANS","JOINVILLE","BALSA NOVA","CORUPA","ELDORADO","FAZENDA RIO GRANDE","RIOZINHO","SAO LOURENCO DA MATA","UNA","URUCUCA","TORRES"],["Rio Sao Jeronimo",null,"Praca Mariano Procopio","Parque Estadual da Serra do Mar-Nucleo Picinguaba","Rio Minador","Serra Dona Francisca","Base da Serra de Sao Luiz do Puruna","Palmeiras II",null,"Fazenda Experimental Gralha Azul 2",null,"Sao Bento","Reserva Biologica de Una","Mun&gt;. Urucuca, 9.4 KM. Serra do Conduru vertente E.","Torres"],["Forest fragment","Coordinates given in the herbarium record","50","Forest fragment","Municipality","Municipality","Coordinates given in the herbarium record","Coordinates given in the herbarium record","Coordinates given in the herbarium record","Forest fragment","Municipality","Coordinates given in the herbarium record","20","Coordinates given in the herbarium record","Forest fragment"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil"],["BR","BR","BR","BR","BR","BR","BR","BR","BR","BR","BR","BR","BR","BR","BR"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],["Tillandsia tenuifolia","Peperomia obtusifolia","Tillandsia recurvata","Vriesea flammea","Lankesterella ceracifolia","Nidularium innocentii","Acianthera serpentula","Peperomia quadrifolia","Peperomia circinnata","Microgramma squamulosa","Vriesea gigantea","Aechmea leptantha","Vriesea tijucana","Rhodospatha oblongata","Anthurium gaudichaudianum"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted"],["GBIF:2695114","GBIF:3086423","GBIF:2695588","GBIF:5289378","GBIF:5312267","GBIF:2697762","GBIF:2839474","GBIF:3086416","GBIF:7304921","GBIF:4025976","GBIF:5288894","GBIF:2698687","GBIF:5288897","GBIF:2871981","GBIF:2872740"],["Tillandsia tenuifolia","Peperomia obtusifolia","Tillandsia recurvata","Vriesea flammea","Lankesterella ceracifolia","Nidularium innocentii","Acianthera serpentula","Peperomia quadrifolia","Peperomia circinnata","Microgramma squamulosa","Vriesea gigantea","Aechmea leptantha","Vriesea tijucana","Rhodospatha oblongata","Anthurium gaudichaudianum"],["species","species","species","species","species","species","species","species","species","species","species","species","species","species","species"],["accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted","accepted"],["GBIF:2695114","GBIF:3086423","GBIF:2695588","GBIF:5289378","GBIF:5312267","GBIF:2697762","GBIF:2839474","GBIF:3086416","GBIF:7304921","GBIF:4025976","GBIF:5288894","GBIF:2698687","GBIF:5288897","GBIF:2871981","GBIF:2872740"],["Plantae","Plantae","Plantae","Plantae","Plantae","Plantae","Plantae","Plantae","Plantae","Plantae","Plantae","Plantae","Plantae","Plantae","Plantae"],["Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta","Tracheophyta"],["Liliopsida","Magnoliopsida","Liliopsida","Liliopsida","Liliopsida","Liliopsida","Liliopsida","Magnoliopsida","Magnoliopsida","Polypodiopsida","Liliopsida","Liliopsida","Liliopsida","Liliopsida","Liliopsida"],["Poales","Piperales","Poales","Poales","Asparagales","Poales","Asparagales","Piperales","Piperales","Polypodiales","Poales","Poales","Poales","Alismatales","Alismatales"],["Bromeliaceae","Piperaceae","Bromeliaceae","Bromeliaceae","Orchidaceae","Bromeliaceae","Orchidaceae","Piperaceae","Piperaceae","Polypodiaceae","Bromeliaceae","Bromeliaceae","Bromeliaceae","Araceae","Araceae"],["Tillandsia","Peperomia","Tillandsia","Vriesea","Lankesterella","Nidularium","Acianthera","Peperomia","Peperomia","Microgramma","Vriesea","Aechmea","Vriesea","Rhodospatha","Anthurium"],["tenuifolia","obtusifolia","recurvata","flammea","ceracifolia","innocentii","serpentula","quadrifolia","circinnata","squamulosa","gigantea","leptantha","tijucana","oblongata","gaudichaudianum"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[8279994,3086367,8279994,2699764,2807134,2697636,7848554,3086367,3086367,8393217,2699764,2697812,2699764,2871974,2872218],[null,3086426,5287808,null,2807162,null,2839476,3086417,null,7290190,null,2698688,null,null,null],["L.","A.Dietr. (L.)","L. (L.)","L.B.Sm.","Mansf. (Barb.Rodr.)","Lem.","F.Barros (Barb.Rodr.)","Kunth (L.)","Link","de la Sota (Kaulf.)","Gaudich.","Leme &amp; J.A.Siqueira (Harms)","E.Pereira","Poepp.","Kunth"],["narrowleaf airplant","pepper face","Tillandsia recta o heno pequeno",null,null,"purpurvattensamlare",null,"fourleaf peperomia",null,null,"jattevriesea",null,null,null,null],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,false,true,true,true,true,true,true,true,true,false,true,true,true],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],[true,true,false,true,true,true,true,true,true,true,true,false,true,true,true]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th>database_id<\/th>\n      <th>verbatim_scientificName<\/th>\n      <th>decimalLatitude<\/th>\n      <th>decimalLongitude<\/th>\n      <th>occurrenceID<\/th>\n      <th>verbatimEventDate<\/th>\n      <th>country<\/th>\n      <th>stateProvince<\/th>\n      <th>county<\/th>\n      <th>locality<\/th>\n      <th>coordinatePrecision<\/th>\n      <th>basisOfRecord<\/th>\n      <th>identifiedBy<\/th>\n      <th>coordinateUncertaintyInMeters<\/th>\n      <th>recordedBy<\/th>\n      <th>country_suggested<\/th>\n      <th>countryCode<\/th>\n      <th>.uncer_terms<\/th>\n      <th>original_search<\/th>\n      <th>suggested_name<\/th>\n      <th>distance<\/th>\n      <th>notes<\/th>\n      <th>taxonID<\/th>\n      <th>scientificName<\/th>\n      <th>taxonRank<\/th>\n      <th>taxonomicStatus<\/th>\n      <th>acceptedNameUsageID<\/th>\n      <th>kingdom<\/th>\n      <th>phylum<\/th>\n      <th>class<\/th>\n      <th>order<\/th>\n      <th>family<\/th>\n      <th>genus<\/th>\n      <th>specificEpithet<\/th>\n      <th>infraspecificEpithet<\/th>\n      <th>parentNameUsageID<\/th>\n      <th>originalNameUsageID<\/th>\n      <th>scientificNameAuthorship<\/th>\n      <th>vernacularName<\/th>\n      <th>.rou<\/th>\n      <th>.val<\/th>\n      <th>.equ<\/th>\n      <th>.zer<\/th>\n      <th>.cap<\/th>\n      <th>.cen<\/th>\n      <th>.urb<\/th>\n      <th>.otl<\/th>\n      <th>.gbf<\/th>\n      <th>.inst<\/th>\n      <th>.dpl<\/th>\n      <th>.summary<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"dom":"Bfrtip","scrollX":true,"fixedColumns":{"leftColumns":2},"columnDefs":[{"className":"dt-right","targets":[2,3,13,35,36]},{"name":"database_id","targets":0},{"name":"verbatim_scientificName","targets":1},{"name":"decimalLatitude","targets":2},{"name":"decimalLongitude","targets":3},{"name":"occurrenceID","targets":4},{"name":"verbatimEventDate","targets":5},{"name":"country","targets":6},{"name":"stateProvince","targets":7},{"name":"county","targets":8},{"name":"locality","targets":9},{"name":"coordinatePrecision","targets":10},{"name":"basisOfRecord","targets":11},{"name":"identifiedBy","targets":12},{"name":"coordinateUncertaintyInMeters","targets":13},{"name":"recordedBy","targets":14},{"name":"country_suggested","targets":15},{"name":"countryCode","targets":16},{"name":".uncer_terms","targets":17},{"name":"original_search","targets":18},{"name":"suggested_name","targets":19},{"name":"distance","targets":20},{"name":"notes","targets":21},{"name":"taxonID","targets":22},{"name":"scientificName","targets":23},{"name":"taxonRank","targets":24},{"name":"taxonomicStatus","targets":25},{"name":"acceptedNameUsageID","targets":26},{"name":"kingdom","targets":27},{"name":"phylum","targets":28},{"name":"class","targets":29},{"name":"order","targets":30},{"name":"family","targets":31},{"name":"genus","targets":32},{"name":"specificEpithet","targets":33},{"name":"infraspecificEpithet","targets":34},{"name":"parentNameUsageID","targets":35},{"name":"originalNameUsageID","targets":36},{"name":"scientificNameAuthorship","targets":37},{"name":"vernacularName","targets":38},{"name":".rou","targets":39},{"name":".val","targets":40},{"name":".equ","targets":41},{"name":".zer","targets":42},{"name":".cap","targets":43},{"name":".cen","targets":44},{"name":".urb","targets":45},{"name":".otl","targets":46},{"name":".gbf","targets":47},{"name":".inst","targets":48},{"name":".dpl","targets":49},{"name":".summary","targets":50}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="mapping-spatial-errors">
<strong>Mapping spatial errors</strong><a class="anchor" aria-label="anchor" href="#mapping-spatial-errors"></a>
</h4>
<p>It is possible to map a column containing the results of <strong>one spatial test each time</strong>, for example records in country centroids (column “.cen”). Besides, we can use the column <strong>“.summary”</strong> to map all records flagged as potentially problematic (i.e., FALSE).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">check_space</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.summary</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># map only records flagged as FALSE</span></span>
<span>  <span class="fu"><a href="../reference/bdc_quickmap.html">bdc_quickmap</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    lon <span class="op">=</span> <span class="st">"decimalLongitude"</span>,</span>
<span>    lat <span class="op">=</span> <span class="st">"decimalLatitude"</span>,</span>
<span>    col_to_map <span class="op">=</span> <span class="st">".summary"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">0.9</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/brunobrr/bdc/master/vignettes/images/map_summary_space_vignette.png" alt=""><p class="caption">Records flagged as potentially problematic</p>
</div>
</div>
<div class="section level4">
<h4 id="report">
<strong>Report</strong><a class="anchor" aria-label="anchor" href="#report"></a>
</h4>
<p>Creating a report summarizing the results of all tests. The report can be automatically saved if <code>save_report = TRUE.</code></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/bdc_create_report.html">bdc_create_report</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">check_space</span>,</span>
<span>                    database_id <span class="op">=</span> <span class="st">"database_id"</span>,</span>
<span>                    workflow_step <span class="op">=</span> <span class="st">"space"</span>,</span>
<span>                    save_report <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">report</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["Identical coordinates","Plain zeros","Records around country capital centroid","Records around country or province centroids","Geographical outliers","Records around the GBIF headquarters","Records around biodiversity institutions","Duplicated coordinates per species","Rounded (probably imprecise) coordinates","Records within urban areas",null,"(*) calculated in relation to total number of records, i.e. 115 records"],[".equ",".zer",".cap",".cen",".otl",".gbf",".inst",".dpl",".rou",".urb",null,null],[0,0,0,0,0,0,0,0,2,6,null,null],[0,0,0,0,0,0,0,0,1.74,5.22,null,null]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th>Description<\/th>\n      <th>Test_name<\/th>\n      <th>Records_flagged<\/th>\n      <th>perc_number_records(*)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","scrollX":true,"fixedColumns":{"leftColumns":2},"columnDefs":[{"className":"dt-right","targets":[2,3]},{"name":"Description","targets":0},{"name":"Test_name","targets":1},{"name":"Records_flagged","targets":2},{"name":"perc_number_records(*)","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="figures">
<strong>Figures</strong><a class="anchor" aria-label="anchor" href="#figures"></a>
</h4>
<p>Here we create figures (bar plots, maps, and histograms) to make the interpretation of the results of data quality tests easier. Figures can be automatically saved if <code>save_figures = TRUE.</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figures</span> <span class="op">&lt;-</span></span>
<span><span class="fu"><a href="../reference/bdc_create_figures.html">bdc_create_figures</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">check_space</span>,</span>
<span>                   database_id <span class="op">=</span> <span class="st">"database_id"</span>,</span>
<span>                   workflow_step <span class="op">=</span> <span class="st">"space"</span>,</span>
<span>                   save_figures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check figures using</span></span>
<span><span class="va">figures</span><span class="op">$</span><span class="va">.rou</span></span></code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/brunobrr/bdc/master/vignettes/images/space_.rou_BAR.png" alt=""><p class="caption">Rounded coordinates</p>
</div>
<div class="figure">
<img src="https://raw.githubusercontent.com/brunobrr/bdc/master/vignettes/images/space_.urb_MAP.png" alt=""><p class="caption">Records within urban areas</p>
</div>
<div class="figure">
<img src="https://raw.githubusercontent.com/brunobrr/bdc/master/vignettes/images/space_summary_all_tests_BAR.png" alt=""><p class="caption">Summary of all tests</p>
</div>
</div>
<div class="section level4">
<h4 id="filtering-the-database">
<strong>Filtering the database</strong><a class="anchor" aria-label="anchor" href="#filtering-the-database"></a>
</h4>
<p>It is possible to remove flagged records (potentially problematic ones) to get a ‘clean’ database (i.e., without test columns starting with “.”). However, to ensure that all records will be evaluated in all the data quality tests (i.e., tests of the taxonomic, spatial, and temporal module of the package), potentially erroneous or suspect records will be removed in the final module of the package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># output &lt;-</span></span>
<span><span class="co">#   check_space %&gt;%</span></span>
<span><span class="co">#   dplyr::filter(.summary == TRUE) %&gt;%</span></span>
<span><span class="co">#   bdc_filter_out_flags(data = ., col_to_remove = "all")</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="saving-the-database">
<strong>Saving the database</strong><a class="anchor" aria-label="anchor" href="#saving-the-database"></a>
</h4>
<p>You can use <span class="underline">qs::qsave()</span> instead of write_csv to save a large database in a compressed format.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use qs::qsave() to save the database in a compressed format and then qs:qread() to load the database</span></span>
<span><span class="va">check_space</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">.</span>,</span>
<span>            <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"Output"</span>, <span class="st">"Intermediate"</span>, <span class="st">"03_space_database.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bruno Ribeiro, Santiago Velazco, Karlo Guidoni-Martins, Geiziane Tessarolo, Lucas Jardim.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
